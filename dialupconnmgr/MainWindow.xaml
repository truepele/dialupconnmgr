<Window x:Class="dialupconnmgr.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:Converters"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        Title="{Binding Watcher.CurrentUsername}" 
        Height="320" Width="300"
        ResizeMode="NoResize"
        Left="{Binding Left, Mode=TwoWay}"
        Top="{Binding Top, Mode=TwoWay}" Icon="Images/iconEDEG5.ico">
    
    <Grid  Margin="20">
        
        <Grid.Resources>
            <converters:BoolInvertConverter x:Key="BoolInvertConverter"/>
            <converters:StringequalityToVisibilityConverter x:Key="StringequalityToVisibilityConverter"/>
            <converters:StringequalityToVisibilityInvertConverter x:Key="StringequalityToVisibilityInvertConverter"/>
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"></converters:BoolToVisibilityConverter>
            <converters:StringequalityToBoolConverter x:Key="StringequalityToBoolConverter"></converters:StringequalityToBoolConverter>
            <converters:BoolToVisibilityInvertConverter x:Key="BoolToVisibilityInvertConverter"></converters:BoolToVisibilityInvertConverter>
            <Style TargetType="TextBlock">
                <Setter Property="FontSize" Value="18"/>
            </Style>
            
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="90"></RowDefinition>
        </Grid.RowDefinitions>



        <tb:TaskbarIcon x:Name="myNotifyIcon"
                    Visibility="Visible"
                    ToolTipText="{Binding Watcher.StateText}"
                    IconSource="/Images/iconEDEG5.ico"
                    DoubleClickCommand="{Binding ShowHideCommand}">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem IsEnabled="True" Header="Exit" Command="{Binding ExitCommand}">
                </MenuItem>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
            </tb:TaskbarIcon>
                    
        
        <StackPanel Grid.Row="0" VerticalAlignment="Top" IsEnabled="{Binding Watcher.IsBusy, Converter={StaticResource BoolInvertConverter}}">
            <ComboBox FontSize="18" Margin="0,3" ItemsSource="{Binding RasEntries}" SelectedItem="{Binding SelectedRasEntrie, Mode=TwoWay}" 
                      DisplayMemberPath="Name" HorizontalContentAlignment="Center"/>
                     <!-- IsEnabled="{Binding Watcher.Disconnected, Converter={StaticResource StringequalityToBoolConverter}}"!-->
            <TextBlock Text ="{Binding Watcher.CurrentUsername}" FontWeight="SemiBold" HorizontalAlignment="Center"/>
            <TextBlock Text ="{Binding Watcher.StateText}" HorizontalAlignment="Center"/>
            <TextBlock TextWrapping="Wrap" Foreground="Red"  HorizontalAlignment="Center"
                       Text ="{Binding Watcher.ErrorText}"/>

            <StackPanel Orientation="Horizontal">
                <Button Margin="10,3" FontSize="18" Command="{Binding ConnectDisconnectCommand}" HorizontalAlignment="Center">
                    <Grid>
                        <TextBlock Text ="Connect" Padding="15,5"
                                    Visibility="{Binding Watcher.ConnectionState, Converter={StaticResource StringequalityToVisibilityInvertConverter}, ConverterParameter=Connected}"/>

                        <TextBlock Text ="Disconnect" Background="OrangeRed" Padding="15,5"
                                    Visibility="{Binding Watcher.ConnectionState, Converter={StaticResource StringequalityToVisibilityConverter}, ConverterParameter=Connected}"/>
                    </Grid>
                </Button>
                <CheckBox VerticalAlignment="Center" IsChecked="{Binding Watcher.IsKeepConnection}">
                    <CheckBox.LayoutTransform>
                        <ScaleTransform ScaleX="1.3" ScaleY="1.3" />
                    </CheckBox.LayoutTransform>
                    Reconnect
                </CheckBox>
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="1" VerticalAlignment="Bottom" Visibility="{Binding Watcher.ConnectionState, Converter={StaticResource StringequalityToVisibilityConverter}, ConverterParameter=Connected}">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Duration: "/>
                <TextBlock Text="{Binding  Watcher.Statistics.ConnectionDuration}"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="BytesReceived: "/>
                <TextBlock Text="{Binding  Watcher.Statistics.BytesReceived}"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="BytesTransmitted: "/>
                <TextBlock Text="{Binding  Watcher.Statistics.BytesTransmitted}"/>
            </StackPanel>
        </StackPanel>
        <ProgressBar Grid.Row="1" Margin="0,10,0,10" VerticalAlignment="Top" Height="10" IsIndeterminate="True" Visibility="{Binding Watcher.IsBusy, Converter={StaticResource BoolToVisibilityConverter}}"></ProgressBar>

    </Grid>
</Window>
